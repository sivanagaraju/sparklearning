#-----------
# sample log
#-----------

DATA=/book/code/bonus_chapters/TF-IDF/data
PROG=/book/code/bonus_chapters/TF-IDF/TF_IDF.py
# keep words if their length is greater than 2
word_length_threshold=2
#
$SPARK_HOME/bin/spark-submit ${PROG} ${DATA} ${word_length_threshold}

input_path= /book/code/bonus_chapters/TF-IDF/data

word_length_threshold=2

doc= 
[
('file:/book/code/bonus_chapters/TF-IDF/data/doc1', 'a crazy fox jumped over red fox and jumped over fox\n'), 
('file:/book/code/bonus_chapters/TF-IDF/data/doc3', 'I do not like cleaning and cooking but I like dogs\nI like playing tennis\n\n'), 
('file:/book/code/bonus_chapters/TF-IDF/data/doc4', 'computer science is great\nfox jumped\n\n'), 
('file:/book/code/bonus_chapters/TF-IDF/data/doc2', 'dogs are the best friend of red fox and I like dogs\ndogs are good\n\n')
]
lines= 
[
('doc1', 'a crazy fox jumped over red fox and jumped over fox'), 
('doc3', 'I do not like cleaning and cooking but I like dogs I like playing tennis'), 
('doc4', 'computer science is great fox jumped'), 
('doc2', 'dogs are the best friend of red fox and I like dogs dogs are good')
]

reduced= [(('doc1', 'fox'), 3), (('doc1', 'jumped'), 2), (('doc1', 'over'), 2), (('doc1', 'red'), 1), (('doc1', 'and'), 1), (('doc3', 'not'), 1), (('doc3', 'and'), 1), (('doc3', 'cooking'), 1), (('doc3', 'playing'), 1), (('doc3', 'tennis'), 1), (('doc4', 'computer'), 1), (('doc4', 'great'), 1), (('doc4', 'fox'), 1), (('doc4', 'jumped'), 1), (('doc2', 'dogs'), 3), (('doc2', 'are'), 2), (('doc2', 'best'), 1), (('doc2', 'like'), 1), (('doc2', 'good'), 1), (('doc1', 'crazy'), 1), (('doc3', 'like'), 3), (('doc3', 'cleaning'), 1), (('doc3', 'but'), 1), (('doc3', 'dogs'), 1), (('doc4', 'science'), 1), (('doc2', 'the'), 1), (('doc2', 'friend'), 1), (('doc2', 'red'), 1), (('doc2', 'fox'), 1), (('doc2', 'and'), 1)]

tf= [('fox', ('doc1', 3)), ('jumped', ('doc1', 2)), ('over', ('doc1', 2)), ('red', ('doc1', 1)), ('and', ('doc1', 1)), ('not', ('doc3', 1)), ('and', ('doc3', 1)), ('cooking', ('doc3', 1)), ('playing', ('doc3', 1)), ('tennis', ('doc3', 1)), ('computer', ('doc4', 1)), ('great', ('doc4', 1)), ('fox', ('doc4', 1)), ('jumped', ('doc4', 1)), ('dogs', ('doc2', 3)), ('are', ('doc2', 2)), ('best', ('doc2', 1)), ('like', ('doc2', 1)), ('good', ('doc2', 1)), ('crazy', ('doc1', 1)), ('like', ('doc3', 3)), ('cleaning', ('doc3', 1)), ('but', ('doc3', 1)), ('dogs', ('doc3', 1)), ('science', ('doc4', 1)), ('the', ('doc2', 1)), ('friend', ('doc2', 1)), ('red', ('doc2', 1)), ('fox', ('doc2', 1)), ('and', ('doc2', 1))]

words= [('fox', 1), ('jumped', 1), ('over', 1), ('red', 1), ('and', 1), ('not', 1), ('and', 1), ('cooking', 1), ('playing', 1), ('tennis', 1), ('computer', 1), ('great', 1), ('fox', 1), ('jumped', 1), ('dogs', 1), ('are', 1), ('best', 1), ('like', 1), ('good', 1), ('crazy', 1), ('like', 1), ('cleaning', 1), ('but', 1), ('dogs', 1), ('science', 1), ('the', 1), ('friend', 1), ('red', 1), ('fox', 1), ('and', 1)]

frequencies= [('dogs', 2), ('are', 1), ('best', 1), ('like', 2), ('good', 1), ('crazy', 1), ('cleaning', 1), ('but', 1), ('science', 1), ('fox', 3), ('jumped', 2), ('over', 1), ('red', 2), ('and', 3), ('not', 1), ('cooking', 1), ('playing', 1), ('tennis', 1), ('computer', 1), ('great', 1), ('the', 1), ('friend', 1)]

idf= [('dogs', 0.3010299956639812), ('are', 0.6020599913279624), ('best', 0.6020599913279624), ('like', 0.3010299956639812), ('good', 0.6020599913279624), ('crazy', 0.6020599913279624), ('cleaning', 0.6020599913279624), ('but', 0.6020599913279624), ('science', 0.6020599913279624), ('fox', 0.12493873660829993), ('jumped', 0.3010299956639812), ('over', 0.6020599913279624), ('red', 0.3010299956639812), ('and', 0.12493873660829993), ('not', 0.6020599913279624), ('cooking', 0.6020599913279624), ('playing', 0.6020599913279624), ('tennis', 0.6020599913279624), ('computer', 0.6020599913279624), ('great', 0.6020599913279624), ('the', 0.6020599913279624), ('friend', 0.6020599913279624)]

tf_idf= [('doc1', ('crazy', 1, 0.6020599913279624, 0.6020599913279624)), ('doc1', ('fox', 3, 0.12493873660829993, 0.3748162098248998)), ('doc1', ('over', 2, 0.6020599913279624, 1.2041199826559248)), ('doc1', ('red', 1, 0.3010299956639812, 0.3010299956639812)), ('doc1', ('and', 1, 0.12493873660829993, 0.12493873660829993)), ('doc1', ('jumped', 2, 0.3010299956639812, 0.6020599913279624)), ('doc2', ('dogs', 3, 0.3010299956639812, 0.9030899869919435)), ('doc2', ('are', 2, 0.6020599913279624, 1.2041199826559248)), ('doc2', ('best', 1, 0.6020599913279624, 0.6020599913279624)), ('doc2', ('like', 1, 0.3010299956639812, 0.3010299956639812)), ('doc2', ('good', 1, 0.6020599913279624, 0.6020599913279624)), ('doc2', ('fox', 1, 0.12493873660829993, 0.12493873660829993)), ('doc2', ('red', 1, 0.3010299956639812, 0.3010299956639812)), ('doc2', ('and', 1, 0.12493873660829993, 0.12493873660829993)), ('doc2', ('the', 1, 0.6020599913279624, 0.6020599913279624)), ('doc2', ('friend', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('dogs', 1, 0.3010299956639812, 0.3010299956639812)), ('doc3', ('like', 3, 0.3010299956639812, 0.9030899869919435)), ('doc3', ('cleaning', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('but', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('and', 1, 0.12493873660829993, 0.12493873660829993)), ('doc3', ('cooking', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('not', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('playing', 1, 0.6020599913279624, 0.6020599913279624)), ('doc3', ('tennis', 1, 0.6020599913279624, 0.6020599913279624)), ('doc4', ('fox', 1, 0.12493873660829993, 0.12493873660829993)), ('doc4', ('great', 1, 0.6020599913279624, 0.6020599913279624)), ('doc4', ('science', 1, 0.6020599913279624, 0.6020599913279624)), ('doc4', ('jumped', 1, 0.3010299956639812, 0.3010299956639812)), ('doc4', ('computer', 1, 0.6020599913279624, 0.6020599913279624))]

+-----+--------+---+-------------------+-------------------+
|DocID|Token   |TF |IDF                |TF-IDF             |
+-----+--------+---+-------------------+-------------------+
|doc1 |crazy   |1  |0.6020599913279624 |0.6020599913279624 |
|doc1 |fox     |3  |0.12493873660829993|0.3748162098248998 |
|doc1 |over    |2  |0.6020599913279624 |1.2041199826559248 |
|doc1 |red     |1  |0.3010299956639812 |0.3010299956639812 |
|doc1 |and     |1  |0.12493873660829993|0.12493873660829993|
|doc1 |jumped  |2  |0.3010299956639812 |0.6020599913279624 |
|doc2 |dogs    |3  |0.3010299956639812 |0.9030899869919435 |
|doc2 |are     |2  |0.6020599913279624 |1.2041199826559248 |
|doc2 |best    |1  |0.6020599913279624 |0.6020599913279624 |
|doc2 |like    |1  |0.3010299956639812 |0.3010299956639812 |
|doc2 |good    |1  |0.6020599913279624 |0.6020599913279624 |
|doc2 |fox     |1  |0.12493873660829993|0.12493873660829993|
|doc2 |red     |1  |0.3010299956639812 |0.3010299956639812 |
|doc2 |and     |1  |0.12493873660829993|0.12493873660829993|
|doc2 |the     |1  |0.6020599913279624 |0.6020599913279624 |
|doc2 |friend  |1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |dogs    |1  |0.3010299956639812 |0.3010299956639812 |
|doc3 |like    |3  |0.3010299956639812 |0.9030899869919435 |
|doc3 |cleaning|1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |but     |1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |and     |1  |0.12493873660829993|0.12493873660829993|
|doc3 |cooking |1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |not     |1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |playing |1  |0.6020599913279624 |0.6020599913279624 |
|doc3 |tennis  |1  |0.6020599913279624 |0.6020599913279624 |
|doc4 |fox     |1  |0.12493873660829993|0.12493873660829993|
|doc4 |great   |1  |0.6020599913279624 |0.6020599913279624 |
|doc4 |science |1  |0.6020599913279624 |0.6020599913279624 |
|doc4 |jumped  |1  |0.3010299956639812 |0.3010299956639812 |
|doc4 |computer|1  |0.6020599913279624 |0.6020599913279624 |
+-----+--------+---+-------------------+-------------------+

